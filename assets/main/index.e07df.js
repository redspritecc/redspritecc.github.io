window.__require=function e(t,n,o){function r(a,c){if(!n[a]){if(!t[a]){var s=a.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var f=n[a]={exports:{}};t[a][0].call(f.exports,function(e){return r(t[a][1][e]||e)},f,f.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<o.length;a++)r(o[a]);return r}({FileSaver:[function(e,t,n){(function(e){"use strict";var o;cc._RF.push(t,"fbb88JBr5BKxp9KfY+Qmlik","FileSaver"),o=function(){var n="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof e&&e.global===e?e:void 0;function o(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}function r(e,t,n){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){s(o.response,t,n)},o.onerror=function(){console.error("could not download file")},o.send()}function i(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(n){}return t.status>=200&&t.status<=299}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var c=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=n.saveAs||("object"!=typeof window||window!==n?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(e,t,o){var c=n.URL||n.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener","string"==typeof e?(s.href=e,s.origin!==location.origin?i(s.href)?r(e,t,o):a(s,s.target="_blank"):a(s)):(s.href=c.createObjectURL(e),setTimeout(function(){c.revokeObjectURL(s.href)},4e4),setTimeout(function(){a(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download","string"==typeof e)if(i(e))r(e,t,n);else{var c=document.createElement("a");c.href=e,c.target="_blank",setTimeout(function(){a(c)})}else navigator.msSaveOrOpenBlob(o(e,n),t)}:function(e,t,o,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return r(e,t,o);var a="application/octet-stream"===e.type,s=/constructor/i.test(n.HTMLElement)||n.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||a&&s||c)&&"undefined"!=typeof FileReader){var f=new FileReader;f.onloadend=function(){var e=f.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},f.readAsDataURL(e)}else{var u=n.URL||n.webkitURL,p=u.createObjectURL(e);i?i.location=p:location.href=p,i=null,setTimeout(function(){u.revokeObjectURL(p)},4e4)}});n.saveAs=s.saveAs=s,void 0!==t&&(t.exports=s)},"function"==typeof define&&define.amd?define([],o):void 0!==n?o():(o(),(void 0).FileSaver={}),cc._RF.pop()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],Home:[function(e,t,n){"use strict";cc._RF.push(t,"87131cfjTJCS5mU99JAyHec","Home");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./Row"),c=cc._decorator,s=c.ccclass,l=c.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selectBtn=null,t.exportBtn=null,t.label=null,t._string="error",t}return r(t,e),t.prototype.start=function(){this.selectBtn.on(cc.Node.EventType.TOUCH_END,this.load,this),this.exportBtn.on(cc.Node.EventType.TOUCH_END,this.save,this)},t.prototype.load=function(){var e=this,t=document.createElement("input");t.type="file",t.addEventListener("change",function(){if(0!==this.files.length){var t=this.files[0],n=new FileReader;n.onload=function(t){var n=t.target.result,o=XLSX.read(n,{type:"binary"});e.dealData(o)},n.readAsBinaryString(t)}else console.log("\u8bf7\u9009\u62e9\u6587\u4ef6\uff01")}),t.click()},t.prototype.dealData=function(e){for(var t=e.SheetNames[0],n=e.Sheets[t],o=XLSX.utils.sheet_to_csv(n).split("\n"),r=new Map,i=1;i<o.length;i++){for(var c=o[i].split(","),s=1,l="",f=c[1],u=0;u<c.length;u++){var p=a.findIndexLayer(u);if(p){var d=c[u];d.length&&(s!==p&&(l+=",",s=p),l+=d)}}var v=r.get(l)||[];r.set(l,v.concat(f))}var h="";r.forEach(function(e,t){for(var n="",o=0;o<e.length;o++)n+=e[o]+(o===e.length-1?"":",");h+="("+t+") "+e.length+" ("+n+")\n"}),this._string=h,console.log(h),this.label.string="\u82d7\uff0c\u70b9\u51fb\u4fdd\u5b58\u6309\u94ae\u8fdb\u884c\u4fdd\u5b58"},t.prototype.save=function(){var e=new Blob([this._string],{type:"text/plain;charset=utf-8"});saveAs(e,"export-result.txt")},i([l(cc.Node)],t.prototype,"selectBtn",void 0),i([l(cc.Node)],t.prototype,"exportBtn",void 0),i([l(cc.Label)],t.prototype,"label",void 0),i([s],t)}(cc.Component);n.default=f,cc._RF.pop()},{"./Row":"Row"}],Row:[function(e,t,n){"use strict";cc._RF.push(t,"a7095JQ/dpIK7U46fONP1/t","Row"),Object.defineProperty(n,"__esModule",{value:!0}),n.findIndexLayer=n.rowIndexs=void 0,n.rowIndexs=["\u5e8f\u53f7","\u6c49\u5b57","\u7b2c\u4e00\u5c42\u7ed3\u6784","\u7b2c\u4e8c\u5c42\u7ed3\u6784","\u7b2c\u4e8c\u5c42\u7ed3\u6784","\u7b2c\u4e09\u5c42","\u7b2c\u4e09\u5c42","\u7b2c\u4e09\u5c42","\u7b2c\u4e09\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u516d\u5c42","\u7b2c\u516d\u5c42","\u7b2c\u516d\u5c42","\u7b2c\u516d\u5c42","\u7b2c\u516d\u5c42","\u7b2c\u516d\u5c42","\u7b2c\u4e03\u5c42","\u7b2c\u4e03\u5c42","\u7b2c\u4e03\u5c42","\u7b2c\u4e03\u5c42","\u7b2c\u516b\u5c42","\u7b2c\u516b\u5c42","\u7ed3\u6784\u5c42\u6570"];var o=["\u96f6","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341"],r=new Map;function i(e){return r.get(e)}(function(){for(var e=0;e<n.rowIndexs.length;e++)for(var t=n.rowIndexs[e],i=0;i<o.length;i++){var a=o[i];if(t.indexOf(a)>0){r.set(e,i);break}}})(),n.findIndexLayer=i,window.findIndexLayer=i,cc._RF.pop()},{}]},{},["FileSaver","Home","Row"]);