window.__require=function e(t,n,o){function r(a,c){if(!n[a]){if(!t[a]){var s=a.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){return r(t[a][1][e]||e)},u,u.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<o.length;a++)r(o[a]);return r}({FileSaver:[function(e,t,n){(function(e){"use strict";var o;cc._RF.push(t,"fbb88JBr5BKxp9KfY+Qmlik","FileSaver"),o=function(){var n="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof e&&e.global===e?e:void 0;function o(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}function r(e,t,n){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){s(o.response,t,n)},o.onerror=function(){console.error("could not download file")},o.send()}function i(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(n){}return t.status>=200&&t.status<=299}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var c=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=n.saveAs||("object"!=typeof window||window!==n?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(e,t,o){var c=n.URL||n.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener","string"==typeof e?(s.href=e,s.origin!==location.origin?i(s.href)?r(e,t,o):a(s,s.target="_blank"):a(s)):(s.href=c.createObjectURL(e),setTimeout(function(){c.revokeObjectURL(s.href)},4e4),setTimeout(function(){a(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download","string"==typeof e)if(i(e))r(e,t,n);else{var c=document.createElement("a");c.href=e,c.target="_blank",setTimeout(function(){a(c)})}else navigator.msSaveOrOpenBlob(o(e,n),t)}:function(e,t,o,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return r(e,t,o);var a="application/octet-stream"===e.type,s=/constructor/i.test(n.HTMLElement)||n.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||a&&s||c)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},u.readAsDataURL(e)}else{var f=n.URL||n.webkitURL,p=f.createObjectURL(e);i?i.location=p:location.href=p,i=null,setTimeout(function(){f.revokeObjectURL(p)},4e4)}});n.saveAs=s.saveAs=s,void 0!==t&&(t.exports=s)},"function"==typeof define&&define.amd?define([],o):void 0!==n?o():(o(),(void 0).FileSaver={}),cc._RF.pop()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],Home:[function(e,t,n){"use strict";cc._RF.push(t,"87131cfjTJCS5mU99JAyHec","Home");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./Row"),c=e("./UiManager");function s(e,t){var n={SheetNames:[t=t||"sheet1"],Sheets:{}};n.Sheets[t]=e;var o=XLSX.write(n,{bookType:"xlsx",bookSST:!1,type:"binary"});return new Blob([function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),o=0;o!=e.length;++o)n[o]=255&e.charCodeAt(o);return t}(o)],{type:"application/octet-stream"})}var l=cc._decorator,u=l.ccclass,f=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selectBtn=null,t.exportBtn=null,t.uiManager=null,t}return r(t,e),t.prototype.start=function(){this.uiManager.setFileStatus(!1),this.selectBtn.on(cc.Node.EventType.TOUCH_END,this.load,this),this.exportBtn.on(cc.Node.EventType.TOUCH_END,this.save,this)},t.prototype.load=function(){var e=this,t=document.createElement("input");t.type="file",t.addEventListener("change",function(){if(0!==this.files.length){var t=this.files[0],n=new FileReader;n.onload=function(t){var n=t.target.result,o=XLSX.read(n,{type:"binary"});e._csv=XLSX.utils.sheet_to_csv(o.Sheets[o.SheetNames[0]]),console.info("XLSX \u8bfb\u53d6\u5b8c\u6210"),e.uiManager.setFileStatus(!0)},n.readAsBinaryString(t)}else console.log("\u8bf7\u9009\u62e9\u6587\u4ef6\uff01")}),t.click()},t.prototype.dealData=function(e){var t,n;console.time("resultMap");var o=this._getResultMap(this._csv,e);console.timeEnd("resultMap"),console.log(o),console.time("sortedResult");var r=this._getSortedResult(o),i=r.layerMap,a=r.sortedResult;console.timeEnd("sortedResult"),console.log(a);for(var c=[],s=0,l=0;l<a.length;l++){var u=a[l],f=o.get(u),p=i.get(u);if(p.length>s){var d=((t={})["\u7ed3\u6784"]="\u7b2c"+p.length+"\u5c42\u5206\u5272\u7ebf",t["\u6570\u91cf"]="\u7b2c"+p.length+"\u5c42\u5206\u5272\u7ebf",t["\u5185\u5bb9"]="\u7b2c"+p.length+"\u5c42\u5206\u5272\u7ebf",t);c.push(d),s=p.length}var v=((n={})["\u7ed3\u6784"]=u,n["\u6570\u91cf"]=f.length,n["\u5185\u5bb9"]=f.toString(),n);c.push(v)}this._result=c},t.prototype.save=function(){var e=parseInt(this.uiManager.getEditBoxContent());console.log("\u5bfc\u51fa"+e+"\u5c42\u6570\u636e"),this.dealData(e),console.log(this._result);var t="test_export.xlsx",n=s(XLSX.utils.json_to_sheet(this._result),t);saveAs(n,t)},t.prototype._getResultMap=function(e,t){void 0===t&&(t=10);for(var n=e.split("\n"),o=new Map,r=1;r<n.length;r++){for(var i=n[r].split(","),c=1,s="",l=i[1],u=0;u<i.length;u++){var f=a.findIndexLayer(u);if(f){if(f>t)break;var p=i[u];p.length&&(c!==f&&(s+=",",c=f),s+=p)}}var d=o.get(s)||[];o.set(s,d.concat(l))}return o},t.prototype._getSortedResult=function(e){var t=new Map;e.forEach(function(e,n){for(var o=n.split(","),r=[],i=0;i<o.length;i++)r[i]=parseInt(o[i]);t.set(n,r)});var n=[];function o(e){for(var o,r=t.get(e),i=!1,a=0;a<n.length;a++){var c=t.get(n[a]);if(r.length<c.length){o=a,i=!0;break}if(!(r.length>c.length)){for(var s=0;s<r.length;s++){var l=r[s],u=c[s];if(l<u){o=a,i=!0;break}if(l!==u)break}if(i)break}}i?n.splice(o,0,e):n.push(e)}return e.forEach(function(e,t){o(t)}),{layerMap:t,sortedResult:n}},i([f(cc.Node)],t.prototype,"selectBtn",void 0),i([f(cc.Node)],t.prototype,"exportBtn",void 0),i([f(c.default)],t.prototype,"uiManager",void 0),i([u],t)}(cc.Component);n.default=p,cc._RF.pop()},{"./Row":"Row","./UiManager":"UiManager"}],LinkedList:[function(e,t,n){"use strict";cc._RF.push(t,"e285cJMKPpLeJvV64jZa0X7","LinkedList"),Object.defineProperty(n,"__esModule",{value:!0}),n.LinkedList=n.LinkedListNode=void 0;n.LinkedListNode=function(e){this.value=e};var o=function(){function e(){this.head=null}return e.prototype.insert=function(e,t){var n=e.next;e.next=t,t.next=n},e}();n.LinkedList=o,cc._RF.pop()},{}],Row:[function(e,t,n){"use strict";cc._RF.push(t,"a7095JQ/dpIK7U46fONP1/t","Row"),Object.defineProperty(n,"__esModule",{value:!0}),n.findIndexLayer=n.CHINESE_NUMBERS=n.rowIndexs=void 0,n.rowIndexs=["\u5e8f\u53f7","\u6c49\u5b57","\u7b2c\u4e00\u5c42\u7ed3\u6784","\u7b2c\u4e8c\u5c42\u7ed3\u6784","\u7b2c\u4e8c\u5c42\u7ed3\u6784","\u7b2c\u4e09\u5c42","\u7b2c\u4e09\u5c42","\u7b2c\u4e09\u5c42","\u7b2c\u4e09\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u56db\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u4e94\u5c42","\u7b2c\u516d\u5c42","\u7b2c\u516d\u5c42","\u7b2c\u516d\u5c42","\u7b2c\u516d\u5c42","\u7b2c\u516d\u5c42","\u7b2c\u516d\u5c42","\u7b2c\u4e03\u5c42","\u7b2c\u4e03\u5c42","\u7b2c\u4e03\u5c42","\u7b2c\u4e03\u5c42","\u7b2c\u516b\u5c42","\u7b2c\u516b\u5c42","\u7ed3\u6784\u5c42\u6570"],n.CHINESE_NUMBERS=["\u96f6","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341"];var o=new Map;function r(e){return o.get(e)}(function(){for(var e=0;e<n.rowIndexs.length;e++)for(var t=n.rowIndexs[e],r=0;r<n.CHINESE_NUMBERS.length;r++){var i=n.CHINESE_NUMBERS[r];if(t.indexOf(i)>0){o.set(e,r);break}}})(),n.findIndexLayer=r,window.findIndexLayer=r,cc._RF.pop()},{}],UiManager:[function(e,t,n){"use strict";cc._RF.push(t,"22ba4W5kiNOKZZEW6KvpurZ","UiManager");var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.statusLabel=null,t.editBox=null,t}return r(t,e),t.prototype.getEditBoxContent=function(){return this.editBox.string},t.prototype.setFileStatus=function(e){this.label.string=e?"\u82d7\uff0c\u8f93\u5165[\u5c42\u6570]\uff0c\u70b9\u51fb[\u4fdd\u5b58]":"\u82d7\uff0c\u70b9[\u9009\u62e9\u6587\u4ef6]",this.statusLabel.string="\u6587\u4ef6\u72b6\u6001\uff1a"+(e?"\u5df2":"\u672a")+"\u8bfb\u53d6",this.statusLabel.node.color=e?cc.color(125,255,125):cc.color(255,125,125)},i([s(cc.Label)],t.prototype,"label",void 0),i([s(cc.Label)],t.prototype,"statusLabel",void 0),i([s(cc.EditBox)],t.prototype,"editBox",void 0),i([c],t)}(cc.Component);n.default=l,cc._RF.pop()},{}]},{},["FileSaver","Home","LinkedList","Row","UiManager"]);